<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SpaceT</title>
    <link rel="stylesheet" type="text/css" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/regular.css">
    <link rel="stylesheet" href="../static/css/bold.css">
    <link rel="stylesheet" href="../static/css/medium.css">
    <link rel="stylesheet" href="../static/css/semibold.css">
    <link rel="icon" type="image/png" href="../static/images/logo.png">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="../static/script/email.js"></script>

    <style>
        .container1 {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            padding: 20px;
            gap: 15px;
            background-color: #ffffff; /* white background */
            font-family: Arial, sans-serif;
            border: 1px solid #000; /* black border */
        }

        h1 {
            margin-right: 20px;
            font-size: 18px;
            color: #fff; /* black text */
        }

        select {
            width: 200px;
            padding: 8px;
            border: 1px solid #000; /* black border */
            border-radius: 5px;
            font-size: 14px;
            color: #000; /* black text */
            background-color: #fff; /* white background */
        }

        button {
            padding: 10px 20px;
            background-color: #7134db; /* purple button */
            border: none;
            border-radius: 5px;
            font-size: 14px;
            color: #fff; /* white text */
            cursor: pointer;
        }

        button:hover {
            background-color: #5b2aad; /* darker purple on hover */
        }

        #flights {
            margin-top: 20px;
            font-size: 14px;
            color: #000; /* black text */
        }
    </style>
</head>
<body>
    <div id="header"></div>

<div class="container1">
    <h1>Choose your destination</h1>

    <select id="fromCity"></select>
    <select id="toCity"></select>
    <input type="date" id="departureDate" style="width: 200px; padding: 8px; border: 1px solid #000; border-radius: 5px; font-size: 14px; color: #000; background-color: #fff;">
    <button onclick="selectFlight()">Show flights</button>

    <div id="flights"></div>
</div>

<div class="container2">
    <p class="text4 bold-text">SUBSCRIBE TO OUR
        NEWSLETTER</p>

    <div class="subscribeForm" >
        <form id="subscribeForm" action="http://localhost:8081/subscribe" method="post">
            <input class="email" type="email" id="email" name="email" placeholder="E-mail"
                   onfocus="if(this.placeholder==='E-mail'){this.placeholder=''}"
                   onblur="if(this.placeholder===''){this.placeholder='E-mail'}">
            <button class="submit medium-text" type="submit">SUBSCRIBE</button>

        </form>
    </div>

    <div id="subscribeMessage" style="display: none; width: 300px; height: 46px; left: 700px; top: 35%; font-family: 'Noto Sans Hebrew', serif; font-size: 16px; color: #FFFFFF;">
        <p calss="regular-text">You have successfully subscribed!</p>
    </div>
</div>

<div class="container3">

    <div class="textbottom">
        <p class="text5 semibold-text">Your Gateway to Global Adventures</p>
        <p class="text6 medium-text">Welcome to SKYWAY! Your journey starts here â€“ book flights quickly and easily with our seamless reservation system.</p>
        <p class="text7 medium-text">Discover great deals, flexible dates, and customizable travel options tailored to your needs. Enjoy a hassle-free booking experience and world-class customer service.</p>
        <p class="text8 medium-text">Ready to fly? Enter your destination and travel dates to find the perfect flight today!</p>
        <p class="text7 medium-text">Don't miss out on our exclusive discounts and seasonal promotions. Save more when you book your tickets in advance or choose from our bundle deals!</p>
        <p class="text8 medium-text">Track your bookings, manage itineraries, and access boarding passes all in one place. Our intuitive platform ensures your travel planning is stress-free.</p>
    </div>


</div>

<div id="footer"></div>

<script src="../static/script/headerANDfooter.js"></script>
<script>
const today = new Date().toISOString().split("T")[0];

// Set the min attribute of the departureDate input to today's date
document.getElementById("departureDate").setAttribute("min", today);

    async function loadCities() {
    const response = await fetch('/flights/select');
    const cities = await response.json();
    const fromCitySelect = document.getElementById('fromCity');
    const toCitySelect = document.getElementById('toCity');

    cities.forEach(city => {
        const option = `<option value="${city.id}">${city.name}</option>`;
        fromCitySelect.innerHTML += option;
        toCitySelect.innerHTML += option;
    });

    // Add event listeners to handle selection changes
    fromCitySelect.addEventListener('change', () => filterToCityOptions(cities));
    toCitySelect.addEventListener('change', () => filterFromCityOptions(cities));
}

function filterToCityOptions(cities) {
    const fromCityValue = document.getElementById('fromCity').value;
    const toCitySelect = document.getElementById('toCity');

    toCitySelect.innerHTML = cities
        .filter(city => city.id !== fromCityValue) // Exclude the selected fromCity
        .map(city => `<option value="${city.id}">${city.name}</option>`)
        .join('');
}

function filterFromCityOptions(cities) {
    const toCityValue = document.getElementById('toCity').value;
    const fromCitySelect = document.getElementById('fromCity');

    fromCitySelect.innerHTML = cities
        .filter(city => city.id !== toCityValue) // Exclude the selected toCity
        .map(city => `<option value="${city.id}">${city.name}</option>`)
        .join('');
}

async function selectFlight() {
    const fromCityId = document.getElementById('fromCity').value;
    const toCityId = document.getElementById('toCity').value;

    if (!fromCityId || !toCityId) {
        alert('Please select both a departure city and a destination.');
        return;
    }

    const response = await fetch(`/flights/available?fromCityId=${fromCityId}&toCityId=${toCityId}`);
    const flights = await response.json();

    const flightsContainer = document.getElementById('flights');
    flightsContainer.innerHTML = '';
    flights.forEach(flight => {
        flightsContainer.innerHTML += `<button onclick="viewSeats(${flight.id})">Flight ${flight.id}</button>`;
    });
}

// Call the loadCities function when the page loads
document.addEventListener('DOMContentLoaded', loadCities);


    async function viewSeats(flightId) {
        window.location.href = `/flight-room.html?flightId=${flightId}`;
    }

    loadCities();
</script>


</body>
</html>